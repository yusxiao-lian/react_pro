{"version":3,"sources":["pages/Rent/Search/index.module.css","pages/Rent/Search/index.js"],"names":["module","exports","root","list","noHistory","tips","tip","Search","cityId","getCity","value","timerId","state","searchTxt","tipsList","renderTips","_this","map","item","react__WEBPACK_IMPORTED_MODULE_9___default","a","createElement","key","community","className","styles","onClick","props","history","replace","id","name","communityName","search","debounce","_ref","Object","E_reactdemo_11_react_04_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_3__","E_reactdemo_11_react_04_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default","mark","_callee","val","res","wrap","_context","prev","next","API","get","params","sent","setState","data","body","stop","_x","apply","this","arguments","handleChange","trim","antd_mobile_lib_search_bar__WEBPACK_IMPORTED_MODULE_1___default","placeholder","onChange","showCancelButton","onCancel","goBack","Component"],"mappings":"8EACAA,EAAAC,QAAA,CAAkBC,KAAA,qBAAAC,KAAA,qBAAAC,UAAA,0BAAAC,KAAA,qBAAAC,IAAA,8PCSGC,6MAEnBC,OAASC,cAAUC,QAInBC,QAAU,OAEVC,MAAQ,CAENC,UAAW,GACXC,SAAU,MAIZC,WAAa,WAGX,OAFqBC,EAAKJ,MAAlBE,SAEQG,IAAI,SAAAC,GAAI,OACtBC,EAAAC,EAAAC,cAAA,MACEC,IAAKJ,EAAKK,UACVC,UAAWC,IAAOnB,IAClBoB,QAAS,WAEPV,EAAKW,MAAMC,QAAQC,QAAQ,YAAa,CACtCC,GAAIZ,EAAKK,UACTQ,KAAMb,EAAKc,kBAIdd,EAAKc,oBAOZC,OAASC,IAAQ,eAAAC,EAAAC,OAAAC,EAAA,EAAAD,CAAAE,EAAAlB,EAAAmB,KAAC,SAAAC,EAAMC,GAAN,IAAAC,EAAA,OAAAJ,EAAAlB,EAAAuB,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EACEC,IAAIC,IAAI,kBAAmB,CAC3CC,OAAQ,CACNlB,KAAMU,EACNX,GAAId,EAAKR,UAJG,OACVkC,EADUE,EAAAM,KAShBlC,EAAKmC,SAAS,CACZrC,SAAU4B,EAAIU,KAAKC,OAVL,wBAAAT,EAAAU,SAAAd,MAAD,gBAAAe,GAAA,OAAApB,EAAAqB,MAAAC,KAAAC,YAAA,GAYd,OAGHC,aAAe,SAAAlB,GAEb,GAAmB,KAAfA,EAAImB,OAEN,OAAO5C,EAAKmC,SAAS,CACnBrC,SAAU,GACVD,UAAW,KAKfG,EAAKmC,SAAS,CACZtC,UAAW4B,IAIbzB,EAAKiB,OAAOQ,4EAwCL,IACCb,EAAY6B,KAAK9B,MAAjBC,QACAf,EAAc4C,KAAK7C,MAAnBC,UAER,OACEM,EAAAC,EAAAC,cAAA,OAAKG,UAAWC,IAAOvB,MAErBiB,EAAAC,EAAAC,cAAAwC,EAAAzC,EAAA,CACE0C,YAAY,mDACZpD,MAAOG,EACPkD,SAAUN,KAAKE,aACfK,kBAAkB,EAClBC,SAAU,kBAAMrC,EAAQsC,YAI1B/C,EAAAC,EAAAC,cAAA,MAAIG,UAAWC,IAAOpB,MAAOoD,KAAK1C,sBA5HNoD","file":"static/js/19.050bacc7.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Search_root__B_pNl\",\"list\":\"Search_list__1-okz\",\"noHistory\":\"Search_noHistory__zM3Kl\",\"tips\":\"Search_tips__22Hkk\",\"tip\":\"Search_tip__2YIr9\"};","import React, { Component } from 'react'\r\n\r\nimport { SearchBar } from 'antd-mobile'\r\n\r\nimport debounce from 'lodash/debounce'\r\n\r\nimport { getCity, API } from '../../../utils'\r\n\r\nimport styles from './index.module.css'\r\n\r\nexport default class Search extends Component {\r\n  // 当前城市id\r\n  cityId = getCity().value\r\n\r\n\r\n  // 定时器id\r\n  timerId = null\r\n\r\n  state = {\r\n    // 搜索框的值\r\n    searchTxt: '',\r\n    tipsList: []\r\n  }\r\n\r\n  // 渲染搜索结果列表\r\n  renderTips = () => {\r\n    const { tipsList } = this.state\r\n\r\n    return tipsList.map(item => (\r\n      <li\r\n        key={item.community}\r\n        className={styles.tip}\r\n        onClick={() => {\r\n          // console.log('单击了', item)\r\n          this.props.history.replace('/rent/add', {\r\n            id: item.community,\r\n            name: item.communityName\r\n          })\r\n        }}\r\n      >\r\n        {item.communityName}\r\n      </li>\r\n    ))\r\n  }\r\n\r\n  // 创建防抖函数，并且赋值给 search 方法\r\n  // 调用： this.search( val )，也就是说传递给 search 方法的参数，最终，就会传递给该回调函数\r\n  search = debounce(async val => {\r\n    const res = await API.get('/area/community', {\r\n      params: {\r\n        name: val,\r\n        id: this.cityId\r\n      }\r\n    })\r\n\r\n    // console.log('关键词搜索小区信息：', res)\r\n    this.setState({\r\n      tipsList: res.data.body\r\n    })\r\n  }, 500)\r\n\r\n  // 关键词搜索\r\n  handleChange = val => {\r\n    // console.log('当前输入内容为：', val)\r\n    if (val.trim() === '') {\r\n      // 如果搜索框中的内容为空，就将 文本框 中的值 和 列表 数据都清空\r\n      return this.setState({\r\n        tipsList: [],\r\n        searchTxt: ''\r\n      })\r\n    }\r\n\r\n    // 不为空，发送请求，获取该关键词对应的小区数据\r\n    this.setState({\r\n      searchTxt: val\r\n    })\r\n\r\n    // 调用 _.debounce 方法创建的防抖函数，来减少请求次数，提升性能\r\n    this.search(val)\r\n\r\n    // 注意：_.debouncd() 方法的作用是用来创建防抖函数的，如果直接把代码放在此处，\r\n    // 会在每次输入内容时，创建一个防抖函数，输入几次，就会创建几个防抖函数。并且多个防抖函数之间没有任何联系\r\n    // 所以，这样，也就无法实现防抖的功能了\r\n    /* const fn = _.debounce(async () => {\r\n      const res = await API.get('/area/community', {\r\n        params: {\r\n          name: val,\r\n          id: this.cityId\r\n        }\r\n      })\r\n\r\n      // console.log('关键词搜索小区信息：', res)\r\n      this.setState({\r\n        tipsList: res.data.body\r\n      })\r\n    }, 500)\r\n\r\n    fn() */\r\n\r\n    /* \r\n    // 每次发送请求之前，先清除上一次的定时器\r\n    // 清除掉上一次的定时器后，定时器中的代码也就不再执行了\r\n    clearTimeout(this.timerId)\r\n    this.timerId = setTimeout(async () => {\r\n      const res = await API.get('/area/community', {\r\n        params: {\r\n          name: val,\r\n          id: this.cityId\r\n        }\r\n      })\r\n\r\n      // console.log('关键词搜索小区信息：', res)\r\n      this.setState({\r\n        tipsList: res.data.body\r\n      })\r\n    }, 500) */\r\n  }\r\n\r\n  render() {\r\n    const { history } = this.props\r\n    const { searchTxt } = this.state\r\n\r\n    return (\r\n      <div className={styles.root}>\r\n        {/* 搜索框 */}\r\n        <SearchBar\r\n          placeholder=\"请输入小区或地址\"\r\n          value={searchTxt}\r\n          onChange={this.handleChange}\r\n          showCancelButton={true}\r\n          onCancel={() => history.goBack()}\r\n        />\r\n\r\n        {/* 搜索提示列表 */}\r\n        <ul className={styles.tips}>{this.renderTips()}</ul>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"],"sourceRoot":""}